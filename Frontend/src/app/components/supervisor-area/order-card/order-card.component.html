<div class="card-container" [ngClass]="getCardClass(trip?.status)" dir="rtl">
  <div *ngIf="!trip" class="loading-container">
    <p-progressSpinner></p-progressSpinner>
    <span>טוען פרטי נסיעה...</span>
  </div>

  <p-card *ngIf="trip" [styleClass]="'trip-card ' + getCardClass(trip?.status)"> 
    <ng-template pTemplate="header">
  <div class="card-header">

    <div class="header-right">
      <p-tag [value]="translateStatus(trip.status)"></p-tag>
    </div>

    <h2 class="header-title">פרטי נסיעה מלאים</h2>

    <div class="header-left">
      <button
        type="button"
        class="back-btn"
        (click)="goBack()"
      >
        <span>חזרה לרשימה</span>
<i class="pi pi-arrow-left"></i>

      </button>
    </div>

  </div>
</ng-template>




    <div class="card-content">
      

      <div class="info-row">
        <div class="info-label">שם משתמש:</div>
        <div class="info-value">{{ getUserNameById(trip.userId) }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">לוחית רישוי:</div>
        <div class="info-value">{{ getPlateNumber(trip.vehicleId) }}</div>
      </div>
      <div class="info-row">
        <div class="info-label">דגם רכב:</div>
        <div class="info-value">{{ getVehicleModel(trip.vehicleId) }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">סוג נסיעה:</div>
        <div class="info-value">{{ translateRideType(trip.tripType) }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">תאריך התחלה:</div>
        <div class="info-value">{{ trip.startDateTime | date:'dd/MM/yyyy HH:mm' }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">תאריך סיום:</div>
        <div class="info-value">{{ trip.endDateTime | date:'dd/MM/yyyy HH:mm' }}</div>
      </div>
      <div *ngIf="trip?.extended_ride_reason != null" class="info-row">
        <span class="info-label">סיבת הנסיעה:</span>
        <span class="info-value">{{ trip?.extended_ride_reason }}</span>
      </div>

      <div class="info-row">
        <div class="info-label">נקודת התחלה:</div>
        <div class="info-value">{{ 'משרד' }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">תחנה/ות עצירה:</div>
        <div class="info-value-stops">{{ getFormattedStops(trip.stop, trip.extraStops) }}</div>
      </div>


      <div class="info-row">
        <div class="info-label">נקודת סיום:</div>
        <div class="info-value">{{ 'משרד' }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">מרחק מוערך:</div>
        <div class="info-value">{{ ceil(trip.estimatedDistanceKm) | number:'1.0-3' }} ק"מ</div>
      </div>

      <div class="info-row">
        <div class="info-label">מרחק אחרי סטייה:</div>
        <div class="info-value-distance">{{ ceil(trip.actualDistanceKm) | number:'1.0-3' }} ק"מ</div>
      </div>

      <div *ngIf="trip?.four_by_four_reason" class="info-row">
        <span class="info-label">סיבת שימוש ברכב {{ trip?.vehicleType }}:</span>
        <span class="info-value">{{ trip?.four_by_four_reason }}</span>
      </div>


      <div class="info-row">
        <div class="info-label">בדיקת רישיון:</div>
        <div class="info-value">
          {{ trip.licenseCheckPassed ? 'עבר בהצלחה' : 'נכשל' }}
        </div>
      </div>

      <div class="info-row">
        <div class="info-label">הוגש בתאריך:</div>
        <div class="info-value">{{ trip.submittedAt | date:'dd/MM/yyyy HH:mm' }}</div>
      </div>
    </div>

    <ng-template pTemplate="footer">
  <div class="card-actions">
    <p-button
      [disabled]="hasTripPassed()"
      class="approve"
      label=" אישור נסיעה "
      styleClass="p-button-success"
      (click)="updateStatus('approved')"
    ></p-button>

    <p-button
      [disabled]="hasTripPassed()"
      class="reject"
      label="דחיית נסיעה"
      styleClass="p-button-danger"
      (click)="updateStatus('rejected')"
    ></p-button>
  </div>
</ng-template>

  </p-card>
</div>