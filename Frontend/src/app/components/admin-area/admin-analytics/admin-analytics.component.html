<div class="analytics-container">
  <div class="chart-card">

    <div class="export-buttons">
      <button *ngIf="activeTabIndex!=3" (click)="exportCSV()"><i class="pi pi-folder" ></i> ייצוא CSV</button>
      <button *ngIf="activeTabIndex!=3" (click)="exportPDF()"><i class="pi pi-file-pdf"></i> ייצוא PDF</button>
      <button *ngIf="activeTabIndex!=3" (click)="exportExcel()"><i class="pi pi-file-excel"></i> ייצוא Excel</button>

      <div class="export-warning" *ngIf="noShowExportWarningVisible">
        אין נתוני אי-הגעה לייצוא כרגע.
      </div>

    </div>
    <small class="export-disclaimer">*הייצוא מתבצע בהתאם לסינונים</small>


    <div class="tab-buttons">
      <button [class.active]="activeTabIndex === 0" (click)="activeTabIndex = 0">
        סטטוס רכבים
      </button>
      <button [class.active]="activeTabIndex === 1" (click)="activeTabIndex = 1">
        סטטוס נסיעות
      </button>
      <button [class.active]="activeTabIndex === 2" (click)="activeTabIndex = 2">
        שימוש חודשי ברכבים
      </button>
      <button [class.active]="activeTabIndex === 3" (click)="activeTabIndex = 3">
        נסיעות לפי משתמש
      </button>
      <button [class.active]="activeTabIndex === 4" (click)="activeTabIndex = 4">
        אי-הגעות</button>
    </div>

    <div>
      <p-tabView [(activeIndex)]="activeTabIndex">




        <p-tabPanel header=" " [headerStyle]="{ display: 'none' }">
          <div>
            <h3 class="section-heading">פילוח סטטוס רכבים</h3>
            <div class="filter-container" style="margin-bottom: 1rem;">
              <label for="vehicleType" style="margin-right: 0.5rem;">מיין לפי סוג רכב:</label>
              <select id="vehicleType" [(ngModel)]="selectedVehicleType" (change)="onVehicleTypeFilterChange()"
                class="form-control" style="display: inline-block; width: auto;">
                <option value="">הכל</option>
                <option *ngFor="let type of vehicleTypes" [value]="type">{{ type }}</option>
              </select>
            </div>

            <div *ngIf="isVehicleNoData;" class="no-data-message">
              אין נתונים להצגה
            </div>
            <p-chart *ngIf="vehicleChartInitialized && vehicleChartData&&!isVehicleNoData" type="pie"
              [data]="vehicleChartData" [options]="vehicleChartOptions"></p-chart>
          </div>
        </p-tabPanel>







        <p-tabPanel header=" " [headerStyle]="{ display: 'none' }">
          <div>
            <h3 class="section-heading">פילוח סטטוס נסיעות</h3>
            <ride-status></ride-status>
           
          </div>
        </p-tabPanel>





        <p-tabPanel header=" " [headerStyle]="{ display: 'none' }">
              <h3 class="section-heading">שימוש ברכבים</h3>
                      <vehicle-usage></vehicle-usage>
        </p-tabPanel>
        





        <p-tabPanel header=" " [headerStyle]="{ display: 'none' }">
          <div>
        <h3 class="section-heading">נסיעות לפי משתמש</h3>
            <user-orders-export></user-orders-export>
            <ng-template #noDataTemplate>
            <div class="no-data-state">
                <div class="no-data-icon"><i class="pi pi-clipboard"></i></div>
            <div class="no-data-message">אין נתונים להצגה בטווח התאריכים הנבחר</div>
            </div>
      </ng-template>
    </div>
        </p-tabPanel>


        <p-tabPanel header=" " [headerStyle]="{ display: 'none' }">
          <h3 class="section-heading">טבלת אי-הגעות של משתמשים</h3>
       <no-shows></no-shows>
        </p-tabPanel>