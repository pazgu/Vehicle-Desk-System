<div
  *ngIf="selectedLog.action === 'DELETE' && selectedLog.entity_type === 'Ride'"
>
  <div class="data-card delete-data">
    <h4>פרטי נסיעה שנמחקה</h4>
    <div class="entity-fields">
      <div class="field-row">
        <div class="field-label">מזהה נסיעה</div>
        <div class="field-value">{{ selectedLog.change_data.id }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">סוג נסיעה</div>
        <div class="field-value">
          {{ translateRideType(selectedLog.change_data.ride_type) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">סטטוס</div>
        <div class="field-value">
          {{ translateRideStatus(selectedLog.change_data.status) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מיקום התחלה</div>
        <div class="field-value">
          {{ getCityName(selectedLog.change_data.start_location) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">יעד</div>
        <div class="field-value">
          {{ getCityName(selectedLog.change_data.destination) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">תחנה</div>
        <div class="field-value">
          {{ getCityName(selectedLog.change_data.stop) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">תאריך התחלה</div>
        <div class="field-value">
          {{
            selectedLog.change_data.start_datetime | date : "dd/MM/yyyy HH:mm"
          }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">תאריך סיום</div>
        <div class="field-value">
          {{ selectedLog.change_data.end_datetime | date : "dd/MM/yyyy HH:mm" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מרחק מוערך (ק"מ)</div>
        <div class="field-value">
          {{ selectedLog.change_data.estimated_distance_km }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מרחק בפועל (ק"מ)</div>
        <div class="field-value">
          {{ selectedLog.change_data.actual_distance_km }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">בדיקת רישיון עברה</div>
        <div class="field-value">
          {{ selectedLog.change_data.license_check_passed ? "כן" : "לא" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">הוזן ע"י</div>
        <div class="field-value">{{ selectedLog.change_data.user_id }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">מזהה רכב</div>
        <div class="field-value">{{ selectedLog.change_data.vehicle_id }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">אירוע חירום</div>
        <div class="field-value">
          <ng-container *ngIf="selectedLog.change_data.emergency_event === null"
            >-</ng-container
          >
          <ng-container *ngIf="selectedLog.change_data.emergency_event === true"
            >כן</ng-container
          >
          <ng-container
            *ngIf="selectedLog.change_data.emergency_event === false"
            >לא</ng-container
          >
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">הוזן ע"י (override)</div>
        <div class="field-value">
          {{ selectedLog.change_data.override_user_id }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">תאריך שליחה</div>
        <div class="field-value">
          {{ selectedLog.change_data.submitted_at | date : "dd/MM/yyyy HH:mm" }}
        </div>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="selectedLog.action === 'DELETE' && selectedLog.entity_type === 'User'"
>
  <div class="data-card delete-data">
    <h4>פרטי משתמש שנמחק</h4>
    <div class="entity-fields">
      <div class="field-row">
        <div class="field-label">תפקיד</div>
        <div class="field-value">
          {{ translateUserRole(selectedLog.change_data.role) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מחלקה</div>
        <div class="field-value">
          {{ getDepartmentNameById(selectedLog.change_data.department_id) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">שם משתמש</div>
        <div class="field-value">{{ selectedLog.change_data.username }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">שם פרטי</div>
        <div class="field-value">{{ selectedLog.change_data.first_name }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">שם משפחה</div>
        <div class="field-value">{{ selectedLog.change_data.last_name }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">מספר עובד</div>
        <div class="field-value">{{ selectedLog.change_data.employee_id }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">אימייל</div>
        <div class="field-value">{{ selectedLog.change_data.email }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">טלפון</div>
        <div class="field-value">
          {{ selectedLog.change_data.phone || "-" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">רישיון ממשלתי</div>
        <div class="field-value">
          {{ selectedLog.change_data.has_government_license ? "כן" : "לא" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">קובץ רישיון</div>
        <div class="field-value">
          <ng-container
            *ngIf="selectedLog.change_data.license_file_url; else noLicenseFile"
          >
            <a [href]="selectedLog.change_data.license_file_url" target="_blank"
              >קובץ רישיון</a
            >
          </ng-container>
          <ng-template #noLicenseFile>לא קיים</ng-template>
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">תוקף רישיון</div>
        <div class="field-value">
          <ng-container
            *ngIf="
              selectedLog.change_data.license_expiry_date;
              else noExpiryDate
            "
          >
            {{
              selectedLog.change_data.license_expiry_date | date : "dd/MM/yyyy"
            }}
          </ng-container>
          <ng-template #noExpiryDate>לא קיים</ng-template>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="
    selectedLog.action === 'DELETE' && selectedLog.entity_type === 'Vehicle'
  "
>
  <div class="data-card delete-data">
    <h4>פרטי רכב שנמחק</h4>
    <div class="entity-fields">
      <div class="field-row">
        <div class="field-label">מספר רישוי</div>
        <div class="field-value">
          {{ selectedLog.change_data.plate_number }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">סוג רכב</div>
        <div class="field-value">{{ selectedLog.change_data.type }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">סטטוס</div>
        <div class="field-value">
          {{ translateRideStatus(selectedLog.change_data.status) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">סוג דלק</div>
        <div class="field-value">
          {{ translateFuelType(selectedLog.change_data.fuel_type) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מודל רכב</div>
        <div class="field-value">
          {{ selectedLog.change_data.vehicle_model }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">מחלקה</div>
        <div class="field-value">
          {{ getDepartmentNameById(selectedLog.change_data.department_id) }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-value">{{ selectedLog.change_data.mileage }}</div>
      </div>

      <div class="field-row">
        <div class="field-label">תאריך סיום ליסינג</div>
        <div class="field-value">
          {{ selectedLog.change_data.lease_expiry | date : "dd/MM/yyyy" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">סיבת הקפאה</div>
        <div class="field-value">
          {{ selectedLog.change_data.freeze_reason || "-" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">פרטי הקפאה</div>
        <div class="field-value">
          {{ selectedLog.change_data.freeze_details || "-" }}
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">שימוש אחרון</div>
        <div class="field-value">
          {{
            selectedLog.change_data.last_used_at
              ? (selectedLog.change_data.last_used_at
                | date : "dd/MM/yyyy HH:mm")
              : "-"
          }}
        </div>
      </div>

      <div class="field-row" *ngIf="selectedLog.change_data.image_url">
        <div class="field-label">תמונה</div>
        <div class="field-value">
          <img
            [src]="selectedLog.change_data.image_url"
            alt="תמונת רכב"
            style="max-height: 120px; max-width: 160px; border: 1px solid #ccc"
          />
        </div>
      </div>
    </div>
  </div>
</div>
